package main

import (
	"context"
	"fmt"

	"github.com/rs/zerolog/log"
	"github.com/sashabaranov/go-openai"
)

// getEmbedding simulates an API call to get the embedding for a CVE description
func getEmbedding(cveDescription string, client *openai.Client) ([]float32, error) {
	resp, err := client.CreateEmbeddings(
		context.Background(),
		openai.EmbeddingRequest{
			Input: []string{cveDescription},
			Model: openai.AdaEmbeddingV2,
		})

	if err != nil {
		return nil, fmt.Errorf("failed to get embedding: %v", err)
	}

	vectors := resp.Data[0].Embedding

	log.Info().Msg("Embedding retrieved successfully")
	return vectors, nil
}
